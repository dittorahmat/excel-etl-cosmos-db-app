# ========================
# Azure Resource Configuration
# ========================

# Azure Resource Group
# -------------------
AZURE_RESOURCE_GROUP=my-excel-etl-rg
AZURE_LOCATION=eastus  # e.g., eastus, westus, westeurope

# ========================
# Azure Cosmos DB Configuration
# ========================
# Get these values from Azure Portal > Cosmos DB > Your Account > Keys
AZURE_COSMOSDB_ACCOUNT=your-cosmosdb-account-name
AZURE_COSMOS_ENDPOINT=https://your-cosmosdb-account-name.documents.azure.com:443/
AZURE_COSMOS_KEY=your-cosmosdb-primary-key
AZURE_COSMOS_DATABASE=excel-data
AZURE_COSMOS_CONTAINER=records
AZURE_COSMOS_PARTITION_KEY=_partitionKey  # Using _partitionKey for better distribution

# ========================
# Azure Storage Configuration
# ========================
# Get these values from Azure Portal > Storage Account > Your Account > Access Keys
AZURE_STORAGE_ACCOUNT=your-storage-account-name
AZURE_STORAGE_KEY=your-storage-account-key
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=your-storage-account;AccountKey=your-storage-key;EndpointSuffix=core.windows.net
AZURE_STORAGE_CONTAINER=excel-uploads

# ========================
# Azure Function App Configuration
# ========================
AZURE_FUNCTION_APP=your-function-app-name
AZURE_FUNCTION_ENDPOINT=https://your-function-app-name.azurewebsites.net
AZURE_FUNCTION_KEY=your-function-key  # Get from Function App > Functions > App Keys

# ========================
# Azure Active Directory Configuration
# ========================
# Register an app in Azure AD and configure these values
AZURE_AD_CLIENT_ID=your-azure-ad-client-id
AZURE_AD_TENANT_ID=your-azure-ad-tenant-id
AZURE_AD_CLIENT_SECRET=your-azure-ad-client-secret
AZURE_AD_CLIENT_ID_URI=api://your-azure-ad-client-id
AZURE_AD_ISSUER=https://login.microsoftonline.com/your-tenant-id/v2.0
AZURE_AD_AUDIENCE=api://your-azure-ad-client-id

# Output environment variables for GitHub Actions
AZURE_STATIC_WEB_APP=your-azure-static-web
AZURE_STATIC_WEB_APP_URL=your-azure-static-web-url
AZURE_STATIC_WEB_APP_API_KEY=your-azure-static-web-api-key

# ========================
# Application Configuration
# ========================

# Environment (development, staging, production)
NODE_ENV=development

# Server Configuration
# -------------------
PORT=3001  # Default port for local development

# File Upload Configuration
# ------------------------
MAX_FILE_SIZE_MB=10  # Maximum file size in MB (default: 10MB)
ALLOWED_FILE_TYPES=.xlsx,.xls,.xlsm,.csv  # Comma-separated list of allowed file extensions

# CORS Configuration (comma-separated list of allowed origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Logging Configuration
# --------------------
LOG_LEVEL=info  # error, warn, info, debug, trace
LOG_FORMAT=json  # json, pretty, simple

# Feature Flags
# ------------
ENABLE_RBAC=false  # Set to true to enable Role-Based Access Control
ENABLE_AUDIT_LOGGING=true  # Log all file operations for auditing

# Retention Policies
# ----------------
BLOB_RETENTION_DAYS=1000  # Number of days to keep uploaded files in blob storage
AUDIT_LOG_RETENTION_DAYS=365  # Number of days to keep audit logs

# Security
# -------
SESSION_SECRET=your-secure-session-secret  # Used for session encryption
JWT_SECRET=your-secure-jwt-secret  # Used for signing JWTs

# Rate Limiting
# -------------
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes in milliseconds
RATE_LIMIT_MAX_REQUESTS=100  # Max requests per window per IP

# API Versioning
# -------------
API_VERSION=1.0.0
API_PREFIX=/api/v1  # API route prefix

# Logging Configuration
# --------------------
LOG_LEVEL=info  # error, warn, info, debug, trace

# Session Configuration
# -------------------
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'));"
SESSION_SECRET=generate-a-strong-secret-here


# ========================
# Azure AD Authentication (Microsoft Identity Platform)
# ========================
# These values are used for Azure AD authentication in your application.
#
# 1. Go to Azure Portal (https://portal.azure.com)
# 2. Navigate to "Azure Active Directory" > "App registrations"
# 3. Click "New registration"
#    - Name: Your app name (e.g., "Excel ETL App")
#    - Supported account types: Select appropriate option
#    - Redirect URI: Select "Single-page application (SPA)" and enter your app's URL
# 4. Click "Register"
#
# After registration:
# - VITE_AZURE_CLIENT_ID: Find as "Application (client) ID" in the app's Overview
# - VITE_AZURE_TENANT_ID: Find as "Directory (tenant) ID" in the app's Overview

# Required for authentication
VITE_AZURE_CLIENT_ID=your_client_id_here
VITE_AZURE_TENANT_ID=your_tenant_id_here

# Optional: Custom authority URL (for custom domains or B2C)
# VITE_AZURE_AUTHORITY=https://login.microsoftonline.com/your_tenant_id

# Optional: API scope for backend access
# Format: api://<api-client-id>/<scope-name>
# VITE_API_SCOPE=api://your_api_client_id/access_as_user

# ========================
# API Key Configuration
# ========================
# Settings for API key authentication and security

# API Key Security
# ----------------
# Enable/disable API key authentication (default: true)
API_KEYS_ENABLED=true

# API Key Settings
# ----------------
# Default expiration time for new API keys (in days)
API_KEY_DEFAULT_EXPIRATION_DAYS=365

# Maximum number of API keys per user
API_KEY_MAX_KEYS_PER_USER=10

# API Key Rate Limiting
# --------------------
# Maximum number of requests per minute per API key
API_KEY_RATE_LIMIT=1000

# IP Security
# ----------
# Enable IP whitelisting for API keys (default: false)
# When enabled, API keys can be restricted to specific IP addresses
API_KEY_ENABLE_IP_RESTRICTIONS=false

# Comma-separated list of allowed IPs that can access the API key endpoints
# Example: "192.168.1.1,192.168.1.2,2001:db8::/32"
API_KEY_ALLOWED_IPS=127.0.0.1,::1

# Logging
# -------
# Enable detailed logging of API key usage (default: false)
API_KEY_LOGGING_ENABLED=false

# Log all API key validations (warning: may be verbose)
API_KEY_LOG_VALIDATIONS=false

# ========================
# Monitoring (Optional)
# ========================
# Azure Application Insights
# APPLICATION_INSIGHTS_CONNECTION_STRING=InstrumentationKey=your-instrumentation-key;IngestionEndpoint=https://your-region.in.applicationinsights.azure.com/

# ========================
# Security Notes
# ========================
# 1. Never commit the actual .env file to version control
# 2. Use Azure Key Vault or similar for production secrets
# 3. Set proper CORS policies for your production domains
# 4. Use proper HTTPS configuration in production
# 5. Set appropriate security headers
# 6. Rotate credentials and secrets regularly
# 7. Use environment-specific configuration files for different environments
